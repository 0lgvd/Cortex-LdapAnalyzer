{
  "script": {
    "description": "Extraction des informations LDAP pour un analyzer Cortex, incluant les machines et leur activité récente.",
    "language": "Python",
    "dependencies": ["ldap3", "json", "os"],
    "steps": [
      {
        "step": "Connexion au serveur LDAP",
        "details": {
          "server": "ldap://10.0.2.15:389",
          "port": 389,
          "bind_dn": "cn=admin,dc=echelon,dc=local",
          "bind_password": "Chargé depuis le fichier LDAP_password."
        }
      },
      {
        "step": "Lecture du mot de passe depuis LDAP_password",
        "details": {
          "file": "LDAP_password",
          "method": "Lecture avec json.load() dans LdapAnalyzer.py"
        }
      },
      {
        "step": "Recherche des machines avec informations opérationnelles",
        "details": {
          "search_base": "ou=computers,dc=echelon,dc=local",
          "search_filter": "(objectClass=inetOrgPerson)",
          "attributes": ["cn", "uid", "description", "modifyTimestamp", "entryUUID"]
        }
      },
      {
        "step": "Filtrage des machines récemment modifiées",
        "details": {
          "filter": "Machines modifiées après une certaine date",
          "attribute": "modifyTimestamp",
          "example_query": "(modifyTimestamp>=20240201000000Z)"
        }
      },
      {
        "step": "Extraction des résultats",
        "details": {
          "format": "JSON",
          "output_file": "ldap_recent_computers.json"
        }
      }
    ]
  }
}

